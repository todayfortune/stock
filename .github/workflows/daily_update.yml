name: Daily MSI Data Collection

on:
  schedule:
    # 1. ì¥ ì‹œì‘ ì§í›„ (í•œêµ­ 09:10 -> UTC 00:10)
    - cron: '10 0 * * 1-5'
    
    # 2. ì ì‹¬ ì‹œê°„ (í•œêµ­ 12:30 -> UTC 03:30)
    - cron: '30 3 * * 1-5'
    
    # 3. ì¥ ë§ˆê° í›„ (í•œêµ­ 15:50 -> UTC 06:50)
    - cron: '50 6 * * 1-5'

  workflow_dispatch:      # ìˆ˜ë™ ì‹¤í–‰ ë²„íŠ¼

permissions:
  contents: write

jobs:
  # ... (ë‚˜ë¨¸ì§€ ì½”ë“œëŠ” ê±´ë“œë¦´ í•„ìš” ì—†ìŒ) ...
  build:
    runs-on: ubuntu-latest
    
    steps:
    - name: ì €ì¥ì†Œ ì²´í¬ì•„ì›ƒ (ì½”ë“œ ê°€ì ¸ì˜¤ê¸°)
      uses: actions/checkout@v3

    - name: íŒŒì´ì¬ ì„¤ì • (3.11 ë²„ì „)
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'

    - name: ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜
      run: |
        pip install finance-datareader yfinance pandas numpy requests lxml

    - name: MSI ìˆ˜ì§‘ê¸° ì‹¤í–‰
      run: |
        python scripts/fetch_krx.py

    - name: ê²°ê³¼ ì €ì¥ (Commit & Push)
      run: |
        git config --global user.name "MSI-Bot"
        git config --global user.email "actions@github.com"
        # ë°ì´í„°ê°€ ë°”ë€Œì—ˆì„ ë•Œë§Œ ì»¤ë°‹ (ë¹ˆ ì»¤ë°‹ ë°©ì§€)
        git add data/*.json
        git commit -m "ğŸ“ˆ Update MSI Data ($(date +'%H:%M'))" || echo "No changes to commit"
        git push
